SHELL = @PORTAGE_BASH@

prefix = @prefix@
exec_prefix = @exec_prefix@
sysconfdir = @sysconfdir@
libdir = @libdir@
PYTHON = @PREFIX_PORTAGE_PYTHON@

srcdir=@srcdir@
top_builddir=@top_builddir@

portageuser = @portageuser@
portagegroup = @portagegroup@

PORTAGE_PYM = @PORTAGE_BASE@/pym
INSTALL = @INSTALL@
INSTALL_subst = ${top_builddir}/subst-install

list_sourcedir_dirs = \
	( cd "$(srcdir)" && find . -name '.git' -prune -o -type d -print | sed 's#^./\?##' )

all:

install:
	$(INSTALL) -d -m 755 -o "$(portageuser)" -g "$(portagegroup)" $(DESTDIR)$(PORTAGE_PYM)
	$(list_sourcedir_dirs) | while read f ; do \
		$(INSTALL) -d -m 755 \
			-o "$(portageuser)" -g "$(portagegroup)" \
			"$(DESTDIR)$(PORTAGE_PYM)/$${f}" && \
		$(INSTALL_subst) \
			-o "$(portageuser)" -g "$(portagegroup)" \
			-t "$(DESTDIR)$(PORTAGE_PYM)/$${f}" \
			"$(srcdir)/$${f}"/*.py \
	; done

.PHONY:	all install

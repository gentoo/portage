# Maintainer: Oskari Pirhonen <xxc3ncoredxx@gmail.com>

image: ubuntu/lts
shell: true
tasks:
  - setup-lint-env: |
      sudo apt-get update
      sudo apt-get install -y --no-install-recommends python-is-python3 python3-venv
      python -m venv .venv
      source .venv/bin/activate
      pip install --upgrade pip
      pip install black

  - black: |
      source .venv/bin/activate
      cd portage
      STRAGGLERS="$(find bin runtests -type f -not -name '*.py' -not -name '*.sh' | \
          xargs grep -l '#!/usr/bin/env python' | \
          tr '\n' ' ')"
      black --check --diff --color . $STRAGGLERS
